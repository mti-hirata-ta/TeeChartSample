<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>TeeChart JavaScript Table to Series Example</title>
<script src="../../src/teechart.js" type="text/javascript"></script>
<script src="../../src/teechart-table.js" type="text/javascript"></script>

<script language="javascript">
function ResizeWidget(id)
{
this.dragMode=false;
this.obj="";
this.apply(id);
}
ResizeWidget.prototype.apply = function(id)
{
var target = document.getElementById(id);
if(!target){
alert("No target");
return;
}
var body=document.getElementsByTagName('body')[0];
this.attachEvent(body,'mousemove',
function(e){ResizeWidget.prototype.startMoving(e)} );
this.attachEvent(body,'mouseup',
function(e){ResizeWidget.prototype.stopMoving(e)}) ;
var tag = target.tagName.toLowerCase();
switch(tag)
{
case "table":
var row = target.getElementsByTagName('tr')[0];
var cols = row.getElementsByTagName('td');
if(!cols || cols.length==0) cols = row.getElementsByTagName('th');
for(var i=0;i<cols.length;i++)
{
this.attachEvent(cols[i], 'mouseover',
function(e){ResizeWidget.prototype.onMouseOver(e)} );
this.attachEvent(cols[i], 'mousedown',
function(e){ResizeWidget.prototype.onMouseDown(e)} );
this.attachEvent(cols[i], 'mouseup',
function(e){ResizeWidget.prototype.onMouseUp(e)});
}
break;
default:
alert("ResizeWidget does not support "+target.tagName);
}
}

ResizeWidget.prototype.toDragMode = function(what)
{
this.dragMode=true;
this.obj=what;
}

ResizeWidget.prototype.startMoving = function(e)
{
if(!this.dragMode) return false;
this.obj.style.width=(e.clientX-20) + 'px';
}

ResizeWidget.prototype.stopMoving = function()
{
this.dragMode=false;
this.obj="";
}
ResizeWidget.prototype.onMouseOver = function(e)
{
var o = this.getEventTarget(e);
o.style.cursor='e-resize';
}
ResizeWidget.prototype.onMouseDown = function(e)
{
var o = this.getEventTarget(e);
this.toDragMode(o);
}
ResizeWidget.prototype.onMouseUp = function(e)
{
var o = this.getEventTarget(e);
this.stopMoving(o);
}
ResizeWidget.prototype.attachEvent = function(object, event, handler){
if(window.addEventListener){ // Mozilla, Netscape, Firefox
object.addEventListener(event, handler, false);
} else { // IE
object.attachEvent('on'+event, handler);
}
}
ResizeWidget.prototype.getEventTarget = function(evt)
{
return evt["srcElement"] ? evt["srcElement"] : evt["target"];
}
</script>

<style type="text/css">
.buti {
	-moz-box-shadow:inset 0px -1px 5px 0px #fce2c1;
	-webkit-box-shadow:inset 0px -1px 5px 0px #fce2c1;
	box-shadow:inset 0px -1px 5px 0px #fce2c1;
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ffc477), color-stop(1, #fb9e25) );
	background:-moz-linear-gradient( center top, #ffc477 5%, #fb9e25 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ffc477', endColorstr='#fb9e25');
	background-color:#ffc477;
	-moz-border-radius:12px;
	-webkit-border-radius:12px;
	border-radius:12px;
	border:1px solid #eeb44f;
	display:inline-block;
	color:#ffffff;
	font-family:Arial;
	font-size:12px;
	font-weight:bold;
	padding:3px 8px;
	text-decoration:none;
	text-shadow:1px 1px 3px #cc9f52;
}.buti:hover {
	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #fb9e25), color-stop(1, #ffc477) );
	background:-moz-linear-gradient( center top, #fb9e25 5%, #ffc477 100% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#fb9e25', endColorstr='#ffc477');
	background-color:#fb9e25;
}.buti:active {
	position:relative;
	top:1px;
}
/* This imageless css button was generated by CSSButtonGenerator.com */

</style>

<style type="text/css">
table.sample {
    border-width: 2px;
    border-spacing: 4px;
    border-style: solid;
    border-color: green;
    border-collapse: separate;
    background-color: white;
    font-family: Arial;
}
table.sample th {
    border-width: 1px;
    padding: 2px;
    border-style: dotted;
    border-color: red;
    background-color: white;
}
table.sample td {
    border-width: 1px;
    padding: 2px;
    border-style: dotted;
    border-color: red;
}
</style>

<script type="text/javascript">
var Chart1;

function draw() {
  Chart1=new Tee.Chart("canvas");
  Chart1.title.text="Data from HTML Table";

  Chart1.axes.bottom.labels.rotation=45;

  enableTableEditing("table1",true,function() { refreshChart(); });
  enableRowHighlight("table1",'gold'); //,'buttons');

  function hoverCell(cell,active) {
    if (active) {
       cell.style.backgroundColor='gold';
       cell.style.color='white';
    }
    else
    {
       cell.style.backgroundColor='';
       cell.style.color='';
    }
  }

  Chart1.onhover=function(series,index) {
    var tbl=document.getElementById('table1');
    var s=series.chart.series.items.indexOf(series)+1;

    var bycols=document.getElementById('bycols').checked;
    if (bycols) {
      if (series.over!=-1)
         hoverCell(tbl.rows[series.over+1].cells[s],false);

      if (index!=-1)
         hoverCell(tbl.rows[index+1].cells[s],true);
    }
    else
    {
      if (series.over!=-1)
         hoverCell(tbl.rows[s].cells[series.over+1],false);

      if (index!=-1)
         hoverCell(tbl.rows[s].cells[index+1],true);
    }
  }

  refreshChart();

  var resizer = new ResizeWidget("table1");
}

function refreshChart() {

  // Load data from html table1 to chart:

  Chart1.fromTable('table1',
              eval(document.getElementById('chartstyle').value), // <-- optional series style
              document.getElementById('bycols').checked,   // <-- by columns or by rows ?
              0,  // <-- header row (-1 if no header)
              0); // <-- labels row (-1 if no labels)
}

</script>
</head>

<body onload="draw()">

<div style="float: left;">

<div id="buttons"> <!-- style="visibility:show; position:fixed;"> -->
<button class="buti" type="BUTTON" onclick="addRow(); refreshChart();">+Row</Button>
<button class="buti" type="BUTTON" onclick="addCol('New'); refreshChart();">+Column</Button>
</div>

</BR>

<table id="table1" class="sample">
<tr><Th>Fruits</Th><th>Sugar</Th><Th>Fiber</Th></TR>
<tr><TD>Apple</TD><td>5</TD><TD>1</TD></TR>
<tr><TD>Kiwi</TD><td>2</TD><TD>4</TD></TR>
<tr><TD>Banana</TD><td>1</TD><TD>7</TD></TR>
</table>

<br/>
<input type="checkbox" id="bycols" onclick="refreshChart();" checked>By Columns<br/>

<select id="chartstyle" onchange="refreshChart();">
  <option value="Tee.Bar">Bar</option>
  <option value="Tee.HorizBar">Horizontal Bar</option>
  <option value="Tee.Area">Area</option>
  <option value="Tee.Line">Line</option>
  <option value="Tee.PointXY">Point</option>
  <option value="Tee.Pie">Pie</option>
  <option value="Tee.Donut">Donut</option>
  <option value="Tee.HorizArea">HorizArea</option>
</select>

</DIV>

<div style="float:left; margin-left:20px">
<br><canvas id="canvas" style="zoom:100%" width="600" height="300">
This browser does not seem to support HTML5 Canvas.
</canvas>
</DIV>

</body>
</html>
